<!DOCTYPE HTML>
<!--This project contains code from the following sources
Previous assignments done in class
https://www.w3schools.com/howto/howto_js_tabs.asp
https://blog.liveedu.tv/javascript-select-value/
https://stackoverflow.com/questions/14496531/adding-two-numbers-concatenates-them-instead-of-calculating-the-sum
https://stackoverflow.com/questions/6341774/keep-track-of-how-much-time-is-spent-showing-certain-elements-on-the-page
https://marina-ferreira.github.io/projects/js/memory-game/
https://www.w3schools.com/howto/howto_js_accordion.asp
https://stackoverflow.com/questions/41632942/how-to-measure-time-elapsed-on-javascript
https://stackoverflow.com/questions/9251837/how-to-remove-all-listeners-in-an-element
https://www.w3schools.com/nodejs/nodejs_mongodb.asp and subsequent MongoDB lesson links on the site
https://stackoverflow.com/questions/40711300/javascript-do-something-every-n-seconds
https://www.w3.org/2005/10/howto-favicon
Code used from Dylan Porter's class project on Crazy Eights

Possibly
https://stackoverflow.com/questions/50448272/avoid-current-url-string-parser-is-deprecated-warning-by-setting-usenewurlpars
-->
<html lang="en">
<head>
    <link rel="icon" 
      type="image/png" 
      href="./Images/kc.png" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>CardGames.org</title>
    <base href="/">
<style>
    /* Style the buttons that are used to open and close the accordion panel */
.accordion {
  background-color: #e3e0cc;
  color: #444;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  text-align: left;
  border: none;
  outline: none;
  transition: 0.4s;
}
    
body {
  height: 100vh;
  background: #9fa9a3; 
}

/* Add a background color to the button if it is clicked on (add the .active class with JS), and when you move the mouse over it (hover) */
.active, .accordion:hover {
  background-color: #f0f0f0;
}

/* Style the accordion panel. Note: hidden by default */
.panel {
  padding: 0 18px;
  background-color: #9fa9a3;
  display: none;
  overflow: hidden;
}

/*Style for title background color vilgax */
div.statusBox {
    border: 2px solid black;
    padding: 3px 0px;
    margin: 3px 0px;
    font-size: 30pt;
    font-family: cursive;
    /*background-color: #893838;*/
    background-color: #1f3f0e;
    text-align: center;
}
    
/* Style the tabs for list of games */
.tab {
  overflow: hidden;
  border: 1px solid #1f3f0e;
  background-color: #9fa9a3;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 20px;
}

/* Change background color of buttons on hover */
.tab button:hover {
  background-color: #ddd;
}

/* Create an active/current tablink class vilgax #8B0000 */
.tab button.active {
  background-color: #719c71;
}
.tablinks {
  background-color: #8B0000;
}
#Account {
  display: block;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-top: none;
}
    .switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:focus + .slider {
  box-shadow: 0 0 1px #2196F3;
}

input:checked + .slider:before {
  -webkit-transform: translateX(26px);
  -ms-transform: translateX(26px);
  transform: translateX(26px);
}
</style>
    <link rel="stylesheet" href="styles-g1.css">
    <link rel="stylesheet" href="Crazy8.css" />
</head>
<body>
    <script type="text/javascript" src="jquery-3.4.1.js"></script>
    <script>
            let sign = false;
            var host=location.origin.replace(/^http/,'ws');
            var ws=new WebSocket(host);
            ws.onmessage=function(event){
                let message=JSON.parse(event.data);
                console.log(message.action);
                //alert(message.action);
                //console.log("Message status is"+message.status);
                if(message.action=="Crazy Eights"){
                    //alert("Crazy Eights online update");
                    console.log("Message status ="+message.status);
                    onlineMes(message);
                }
                else if(message.action=="Snip Snap Snorum"){
                    //alert("Snip Snap Snorum online update");
                    snipUpdate(message);
                }
                else if(message.action=="Go Fish"){
                    //alert("Go Fish Online update");
                    fishUpdate(message);
                }
                else if(message.action=="Show user"){
                    document.getElementById("User").innerHTML=message.user;
                }
                else if(message.action=="Creation"){
                    //Failed to create a login
                    document.getElementById("Creation_status").innerHTML=message.status;
                }
                else if(message.action=="Login"){
                    //alert("Processing a login");
                    document.getElementById("Login_status").innerHTML=message.status;
                }
                else if(message.action=="Solo"){
                    //Display your position on the leaderboard
                    ///////////
                    let l=message.board;
                    //alert("Attempting a solo leaderboard "+message.type);
                    let b=document.getElementById("score");
                    if(l==null){
                         b.innerHTML="You are not present on this leaderboard";
                    }else{
                       if(message.type=="Crazy Eights moves"){
                            b.innerHTML=l.screenname+" "+l.moves+" moves";
                        }
                        else if(message.type=="Snip Snap Snorum times"){
                            b.innerHTML=l.screenname+" "+l.mins+" mins "+l.secs+" secs";
                        }
                        else if(message.type=="Go Fish fours"){
                            b.innerHTML=l.screenname+" "+l.fours+" fours";
                        }
                        else if(message.type=="War record"){
                            b.innerHTML=l.screenname+" "+l.wins+" wins "+l.losses+" losses";
                        }
                        else if(message.type=="Match moves"){
                            b.innerHTML=l.screenname+" "+l.moves+"moves";
                        }
                        else if(message.type=="Blackjack record"){
                            b.innerHTML=l.screenname+" "+l.wins+" wins "+l.losses+" losses";
                        }
                        else if(message.type=="Solitare score"){
                            b.innerHTML=l.screenname+" "+l.score+" points<br>";
                        }
                    }
                }
                else if(message.action=="Leaderboard"){
                    //Display the leaderboard in the message
                    let l=message.board;
                    let length=l.length
                    if(l.length>20){
                        length=20;
                    }
                    //alert("Printing Crazy Eights leaderboard");
                    let b=document.getElementById("board");
                    for(var i=0; i<length; i++){
                        if(message.type=="Crazy Eights moves"){
                            //alert("Printing Crazy Eights leaderboard");
                            b.innerHTML=b.innerHTML+(i+1)+" "+l[i].screenname+" "+l[i].moves+" moves<br>";
                        }
                        else if(message.type=="Snip Snap Snorum times"){
                            b.innerHTML=b.innerHTML+(i+1)+" "+l[i].screenname+" "+l[i].mins+" mins "+l[i].secs+" secs<br>";
                        }
                        else if(message.type=="Go Fish fours"){
                            b.innerHTML=b.innerHTML+(i+1)+" "+l[i].screenname+" "+l[i].fours+" fours<br>";
                        }
                        else if(message.type=="War record"){
                            b.innerHTML=b.innerHTML+(i+1)+" "+l[i].screenname+" "+l[i].wins+" wins "+l[i].losses+" losses<br>";
                        }
                        else if(message.type=="Match moves"){
                            b.innerHTML=b.innerHTML+(i+1)+" "+l[i].screenname+" "+l[i].moves+" moves<br>";
                        }
                        else if(message.type=="Blackjack record"){
                            b.innerHTML=b.innerHTML+(i+1)+l[i].screenname+" "+l[i].wins+" wins "+l[i].losses+" losses<br>";
                        }
                        else if(message.type=="Solitare score"){
                            b.innerHTML=b.innerHTML+(i+1)+l[i].screenname+" "+l[i].score+" points<br>";
                        }
                    }
                }
                ///*
                else if(message.action=="War"){
                    //alert("war");
                    let s=document.getElementById("warstatus");
                    s.innerHTML=s.innerHTML+message.message;
                }
                else if(message.action=="Matching"){
                     //alert("match");
                    let s=document.getElementById("matchstatus");
                    s.innerHTML=s.innerHTML+message.message;
                }
                else if(message.action=="SpiderSolitare"){
                     //alert("spider");
                    let s=document.getElementById("Solstatus");
                    s.innerHTML=s.innerHTML+message.message;
                }
                else if(message.action="Blackjack"){
                    // alert("jack");
                    let s=document.getElementById("jackstatus");
                    s.innerHTML=s.innerHTML+message.message;
                }//*/
            }
            
            //Ping server every so often to prevent server timeout
            window.setInterval(pingServer,7000);
        
        function pingServer(){
            ws.send(JSON.stringify({action:"ping"}));
        }
    </script>
<!--		
<div id="Title" class="statusBox">Welcome to CardGames.org</div>
<img src="image-L.png" alt="cards" align="right" height="220">
<img src="image-R.png" alt="cards" align="left" height="220">
<h3 style="text-align: center; font-style: italic">
	Play your favorite game. Create an account to log your high score.<br>
    (* Online games.)</h3>
-->
	<center> <img src="PlayingCards4.jpg" alt="cards" align="Center" height="300"></center>

		
	<br>

	<p class="a" style="color: black">
        <!--This site is currently under construction. Some features might not work as intended.<br>-->
		The games on this site may not work with versions of Internet Explorer.<br>
    </p>
    <br>
    <!--<p class="a" style="color: black"> (* Online games.)<br>Leaderboard records offline games only</p>-->
    <p class="a" style="color: black"> (* Online games.)<br><b>All Leaderboards and login functions have been temporaily disabled. <br> 
        Work is currently being done to bring them back online.</b><br>
        <a href="https://github.com/kucharze/Cardgames-node">See the githubpage behind this page</a></p>
<br>
<div class="tab">
    <button class="tablinks" onclick="openTab(event, 'Account')">Handle accounts</button>
    <button class="tablinks" onclick="openTab(event, 'sugestions')">Suggestions</button>
    <button class="tablinks" onclick="openTab(event, 'boards')">Leaderboards</button>
	</div>

<div class="tab">
    <button class="tablinks" onclick="openTab(event, 'Eight')">Crazy Eights*</button>
    <button class="tablinks" onclick="openTab(event, 'Snap')">Snip Snap Snorum*</button>
    <button class="tablinks" onclick="openTab(event, 'Jack')">Blackjack</button>
    <button class="tablinks" onclick="openTab(event, 'Match')">Matching</button>
    <button class="tablinks" onclick="openTab(event, 'gofish')">Go Fish*</button>
    <button class="tablinks" onclick="openTab(event, 'solitare')">Spider Solitare</button>
    <button class="tablinks" onclick="openTab(event, 'War')">War</button>
</div>

<div style="text-align: center" id="Account" class="tabcontent">
	
    <p>Active User:</p>
	<label id="User">No User logged in</label>

<div>		
	 <br> 
	<h2>Create a Login to have your name added to leaderboards</h2>
</div>
		
	<p id="Creation_status">login</p>
    <pre style="font-size: 20px; color: black; font-family:inherit">Name                   Screenname</pre>
    <input id="user" type="text"> <input id="screenname" type="text"><br>
    <pre style="font-size: 20px; color: black; font-family:inherit">Password                  Confirm Password
    (Must be 8 characters)</pre>
    <input id="pass" type="password"> <input id="pass2" type="password">
    <br><br>
    <input type="button" onclick="insert()" value="Create an account">
    <br><br>
	
	<div>		
	<br><br> 
	<h2>Already have an account? Sign in here.</h2>

        <p id="Login_status"></p>
            <pre style="font-size: 20px; color: black; font-family:inherit">Screenname                       Password</pre>
            <input type="text" id="username" name="User"> <input type="password" id="password" name="Pass">
            <br><br>
            <input type="submit" value="Login" onclick="login()">
	</div>

        <script>
            function insert(){
                
                if(valid()==true)
                {
                    sign=true;
                    let data={};
                    data.action="create";
                    data.user=user;
                    data.screenname=screen;
                    data.password=pass;
                    ws.send(JSON.stringify(data));
                
                    //document.getElementById("8on").disabled=false;
                    //table.innerHTML=table.innerHTML+"Username:"+user+" Password:"+pass;
                    document.getElementById("screenname").innerHTML="";
                    document.getElementById("user").innerHTML="";
                    document.getElementById("pass").innerHTML="";
                    document.getElementById("pass2").innerHTML="";
                }
            }

            function valid(){
                var user = document.getElementById("user").value;
                var screen=document.getElementById("screenname").value;
                var pass = document.getElementById("pass").value;
                var pass2=document.getElementById("pass2").value;

                if(user=="" || pass=="" || pass2=="" || screen=="" || user==null || pass==null || pass2==null || screen==null){
                    //let cr=document.getElementById("Creation_status");
                    //alert(cr);
                    document.getElementById("Creation_status").innerHTML="Not enough information provided";
                    //cr.innerHTML="Not enough information provided";
                    //alert("Not enough information provided");
                    return false;
                }
                else if(pass.length<8){
                    //cr.innerHTML="Password must be at least 8 characters long";
                     document.getElementById("Creation_status").innerHTML="Password must contain at least 8 characters";
                    return false;
                }
                else if(pass != pass2){
                    //cr.innerHTML="Passwords do not match";
                     document.getElementById("Creation_status").innerHTML="Passwords do not match";
                    return false;
                }
                return true;
            }
            
            function login(){
                var user=document.getElementById("username").value;
                var pass=document.getElementById("password").value;
                let mess={};
                mess.action="login";
                mess.user=user;
                mess.password=pass;
                ws.send(JSON.stringify(mess));
            }
            
        </script>
    </div>

<div id="Eight" class="tabcontent"><!--Crazy Eights-->
        <!-- Status area -->
    <div id="status" class="statusBox">Crazy Eights</div>
    <center><input type="button" value="Reset the game" id="reset8" style="font-size: 18px" onclick="crazyReset()"></center>
    <div id="allCards">
    <!-- Computer's hand -->
    <h2>Computer</h2>
    <div id="myHand" class="hand"></div>
        <br><br><br><br><br><br><br>
    <!-- "table" is div holding deck and discard pile images.
         Initially show card back for pile (replaced by program). -->
    <div id="table"><img id="deck"
      src="./Images/cardback.png" 
      alt="Deck: click to pick a card."
      class="card clickable"/>
        <img id="pile"
      src="./cardback.png" 
      alt="Discard pile top."
      class="card"/></div>
        <br><br>
    <!-- User's hand -->
    <h2>Player 1</h2>
    <div id="yourHand" class="hand"></div>
        <br><br><br>
    <!-- 
	 The suit-picker popup displayed when the user plays an 8.
         Initially not visible.
      -->
    <div id="suitPicker">
      Pick a suit:
      <div id="suitImages">
	   <span id="c" class="clickable">&clubs;</span>
	   <span id="d" class="clickable">&diams;</span>
	   <span id="h" class="clickable">&hearts;</span>
	   <span id="s" class="clickable">&spades;</span>
      </div>
    </div>
    </div>
    <br><br>
    <br><br>
    <h2>Toggle Online mode</h2>
<label class="switch">
  <input type="checkbox" onclick="onlineEight()">
  <span class="slider"></span>
</label>
        <br>
    <br><br>
    <h3>Feature coming soon</h3>
    <textarea maxlength="200"></textarea>
    <input type="text" size="50">
    <button value="Sumbit">Sumbit value</button>
    <button style="font-size: 20px" class="accordion">View Instructions</button>
    <div class="panel">
        <h2>Crazy Eights rules</h2>
        <p>Seven cards are dealt to each player.<br>
            The remaining cards of the deck are placed face down on the table.<br> 
            The top card is then turned face up to start the game.<br>
            Goal is to get rid of all your cards first.<br>
            When it is your turn, select a card from your hand with matching number/rank or suit with the top card of the discard pile.<br>
            If you are unable to match card or number, and you have an 8; you can play it.<br>
            If you do not have an 8 or matching card, you must draw a card from the stockpile.<br> 

            When a player plays an 8, they must declare the suit that the next player is to play; that player must then follow the named suit or play another 8.<br>
            Example: a 6 clubs is currently on the pile. You can<br>
            - play any 6<br>
            - play any card with suit clubs<br>
            - play any 8 (You must then declare a suit)<br> 
            - draw from the stockpile<br>

            The first player to empty their hand wins.<br></p>
    </div>
    
  <!--  <script src="test.js"></script> -->
    <!-- Load the model classes. -->
    <script src="Card.js"></script>
    <script src="Deck.js"></script>
    <script src="Pile.js"></script>
    <script src="Player.js"></script>

    <!-- Load the view class. -->
    <script src="View.js"></script>

    <!-- Load the presenter classes. -->
    <script src="ComputerPlayer.js"></script>
    <script src="HumanPlayer.js"></script>
    <script src="Presenter.js"></script>
    <script src="Online/Presenter8O.js"></script>
    <script src="Online/HumanPlayer8O.js"></script>
    <script src="Online/View8O.js"></script>

    <!-- Run the program. -->
    <script>
        //Play one round of Crazy Eights against the computer
        var presenter = new Presenter(ws);
        presenter.play();
        let online = false;
        
        function crazyReset(){
            presenter.resetGame();
        }
        
        function onlineEight(){
            //alert("online button test");
            if(!online){
                //clear current board and set up online presenter
                presenter.goOnline();
                presenter=new Presenter8O(ws);
                //alert("we are now online");
                document.getElementById("reset8").disabled=true;
                online=true;
                let on={};
                on.action="Crazy Eights";
                on.gameact="Play";
                ws.send(JSON.stringify(on));
            }
            else{
                //shut off online mode
                online=false;
                let quit={};
                quit.action="Crazy Eights";
                quit.gameact="quit";
                ws.send(JSON.stringify(quit));
                presenter.goOffline();
                presenter=new Presenter();
                presenter.play();
                document.getElementById("reset8").disabled=false;
            }
        }
        
        function onlineMes(message){
            //call online presenter update function
            if(online){
                presenter.update(message);
            }
            else{
                document.getElementById('status').innerHTML=document.getElementById('status').innerHTML + " "+ message.message;
            }
        }
    </script>
    </div>
    
    <div id="Jack" class="tabcontent">
        <div id="jackstatus" class="statusBox">Blackjack</div>
        <center><input type="button" value="Reset the game" style="font-size: 18px" onclick="resetJack()"></center>
        
        <h3>Dealer</h3>
        <div id="dealerhand"><img alt="dealer" src="Images/cardback.png"></div>
        <br><br><br><br><br><br>
        <h2>Dealer Hand value</h2>
        <label id="Dealer value"></label>
        <br><br>
        <h2>Player</h2>
        <div id="playerhand"><img alt="dealer" src="Images/cardback.png"></div>
        <br><br><br><br><br><br>
        <h3>Player Hand value</h3>
        <label id="Hand value"></label>
        <br><br>
        <input type="button" id="hit" value="Hit" onclick=hit() style="font-size: 18px">...........
        <input type="button" id="stand" value="Stand" onclick=stand() style="font-size: 18px"> 
        <br><br><br>

        <h3>Feature coming soon</h3>
        <textarea maxlength="200"></textarea>
        <input type="text" size="50">
        <button value="Sumbit">Sumbit value</button>

        <button style="font-size: 20px" class="accordion">View Game Instructions</button>
        <div class="panel">
                        
        <p><h2>Blackjack Rules</h2>
        <p>Most think the object of blackjack is to get to 21 as possible. <br>
        The main object is to beat the dealer without going over.<br>
To beat the dealer the player must first not go over 21 and either outscore the dealer or have the dealer go over 21. Here are the full rules of the game.<br>
1.	Aces may be counted as 1 or 11 points, 2 to 9 according to pip value, and tens and face cards count as ten points.<br>
2.	The value of a hand is the sum of the point values of the individual cards. A "blackjack" is the highest hand.  (Any 10-point card and an Ace = 21 points).<br>
3.	The following are the choices available to the player: <br>
•	Stand: Player stands pat with his cards.<br>
•	Hit: Player draws another card (and more if he wishes). If this card causes the player's total points to exceed 21 (known as "breaking" or "busting") then he loses.<br>
4.	After each player has had his turn, the dealer will turn over his hole card. If the dealer has 16 or less, then he will draw another card. A special situation is when the dealer has an ace and any number of cards totaling six points (known as a "soft 17"). At some tables, the dealer will also hit a soft 17.<br>
5.	If the dealer goes over 21 points, then any player who didn't already bust will win.<br>
6.	If the dealer does not bust, then the higher point total between the player and dealer will win.<br>
</p>
        </div>
        <script src="Jackplayer.js"></script>
        <script src="Jackpres.js"></script>
        <script src="Jackview.js"></script>
        <script>
            let jack=new Jackpres(ws);
            jack.play();
            
            function stand(){jack.stand();}
            
            function hit(){jack.hit();}
            
            function resetJack(){jack.resetGame();}
        </script>
    </div>
    
    <div id="Snap" class="tabcontent">
        <div id="allSnips">
        <div id="snipstatus" class="statusBox">Snip Snap Snorum</div>
            <center><input type="button" id="passturn" value="Pass the turn" style="font-size: 18px" onclick="cpuTurn()">.... <input type="button" id="snipreset" value="Reset the game" style="font-size: 18px" onclick="snipReset()"></center>
            <br><br>
            <h2>Computer</h2>
        <div id="scpuhand"><img alt="cpuhand" src="Images/cardback.png"></div>
        <br><br><br><br><br><br>
        <div id="stable"><img id="spile" src="./cardback.png" alt="Discard pile top." class="card"/></div>
        
        <br><br><br><br><br><br><br>
        
        <h2>Player 1</h2>
        <div id="suserhand"><img alt="playerhand" src="Images/cardback.png" title="start card"></div>
        <br><br><br><br><br><br><br><br>
        </div>
        
        <h2>Toggle Online mode</h2>
        <label class="switch">
        <input type="checkbox" onclick="snipOnline()">
        <span class="slider"></span>
        </label>
        <br><br><br><br><br><br>
        
        <h3>Feature coming soon</h3>
        <textarea maxlength="200"></textarea>
        <input type="text" size="50">
        <button value="Sumbit">Sumbit value</button>
        <br><br>
        
        <button style="font-size: 20px" class="accordion">View Instructions</button>
        <div class="panel">
            <h1>Snip Snap Snorum</h1>
            <p>The cards in each suit rank: K(high),Q,J,10,9,8,7,6,5,4,3,2,A.<br>
                The goal is to be the first player to get rid of all his cards.<br>
                Deal the cards out completely.  The object of the game is to get rid of all your cards.<br>
                The player starts by placing any card down on the table.<br>
                The next player looks to see if they have a card of the same rank.<br> 
                If they do, they place it down on top of the card, saying "Snip".<br>
                If they have another card of the same rank, they place it down too, saying "Snap". <br>
                If they don't, play passes to the next player<br>
                If that player passes play back without making a move, the round will be reset at snip witht eh first player's turn<br>
                Whoever places the final card of that rank says "Snorem" and wins the right to start the next round with the card of their choice.<br>
                Example: the first card played = 5 Clubs, the next card to be played = 5 Hearts, then 5 Diamonds, and 5 Spades.</p>
            </div> 
            <script src="Snip-Snap-Snorum/Snippres.js"></script>
            <script src="Snip-Snap-Snorum/Snipview.js"></script>
            <script src="Snip-Snap-Snorum/Snipcpu.js"></script>
            <script src="Snip-Snap-Snorum/Sniphuman.js"></script>


        <script src="Online/SnippresO.js"></script>
        <script src="Online/SnipviewO.js"></script>
        <script>
            let snip=new Snippres(ws);
            snip.play();
            let snipOn=false;//to determine if we are online or offline
            
            function snipReset(){
                snip.resetGame();
            }
            
            function cpuTurn(){
                if(snipOn){
                    //presenter.passturn
                    //send info to websocket about card on pile,
                    //status and cards in players hand
                    snip.sendMes();
                }
                else{//normal offline function
                    snip.comTurn()
                }
            }
            
            function snipOnline(){
                if(!snipOn){
                    //call online snip snap snorum function
                    snipOn=true;
                    snip.goOnline();
                    snip=new SnippresO(ws);
                    
                    let mes={};
                    mes.action="Snip Snap Snorum";
                    mes.gameact="Play";
                    ws.send(JSON.stringify(mes));
                    document.getElementById("snipreset").disabled=true;
                }else{
                    //shut off online mode
                    document.getElementById("snipreset").disabled=false;
                    document.getElementById("passturn").disabled=false;
                    snipOn=false;
                    let quit={};
                    quit.action="Snip Snap Snorum";
                    quit.gameact="quit";
                    ws.send(JSON.stringify(quit));
                    snip.goOffline();
                    snip=new Snippres();
                    snip.play();
                }
            }
            
            function snipUpdate(message){
                //alert("message action is"+message.action);
                if(snipOn){
                   snip.update(message); 
                }
                else{ document.getElementById('snipstatus').innerHTML=document.getElementById('snipstatus').innerHTML + " "+ message.message;
                }
            }
        </script>
    </div>

<div id="Match" class="tabcontent">
    <div id="matchstatus" class="statusBox">Memory Matcher</div>
        <label class="mem">Try to match the cards in as little turns as possible</label><br>
    <h3>Feature coming soon</h3>
    <textarea maxlength="200"></textarea>
    <input type="text" size="50">
    <button value="Sumbit">Sumbit value</button>
    
    <button style="font-size: 20px" class="accordion">View Instructions</button>
        <div class="panel">
            <p><h2>Matching</h2>
        <p>Flip over two cards.<br>
        If they have the same image on them keep them flipped over.<br>
        Otherwise flip them back.<br>
        Flip over all cards to win.</p>
        </div>
        <br><br>
        <input type="button" value="Reset the game" style="font-size: 18px" onclick="resetGame()">
    <div class="memory-game">
    <div class="memory-card" data-framework="apple1">
      <img class="front-face" src="cards/apple1.PNG" alt="card"  />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
    <div class="memory-card" data-framework="apple1">
      <img class="front-face" src="cards/apple1.PNG" alt="card" />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>

    <div class="memory-card" data-framework="butterfly1">
      <img class="front-face" src="cards/butterfly1.PNG" alt="card" />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
    <div class="memory-card" data-framework="butterfly1">
      <img class="front-face" src="cards/butterfly1.PNG" alt="card" />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>

    <div class="memory-card" data-framework="cow1">
     <img class="front-face" src="cards/cow1.PNG" alt="card" />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
    <div class="memory-card" data-framework="cow1">
          <img class="front-face" src="cards/cow1.PNG" alt="card" />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>

    <div class="memory-card" data-framework="dog1">
        <img class="front-face" src="cards/dog1.PNG" alt="card" />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
    <div class="memory-card" data-framework="dog1">
         <img class="front-face" src="cards/dog1.PNG" alt="card" />
      <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>

    <div class="memory-card" data-framework="flower">
           <img class="front-face" src="cards/flower.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
    <div class="memory-card" data-framework="flower">
         <img class="front-face" src="cards/flower.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>

    <div class="memory-card" data-framework="heart1">
       <img class="front-face" src="cards/heart1.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
    <div class="memory-card" data-framework="heart1">
      <img class="front-face" src="cards/heart1.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
	 </div>

	<div class="memory-card" data-framework="hand1">
       <img class="front-face" src="cards/hand1.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
    <div class="memory-card" data-framework="hand1">
      <img class="front-face" src="cards/hand1.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
	 </div>

	 <div class="memory-card" data-framework="lightbulb1">
       <img class="front-face" src="cards/lightbulb1.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
    </div>
     <div class="memory-card" data-framework="lightbulb1">
       <img class="front-face" src="cards/lightbulb1.PNG" alt="card" />
     <img class="back-face" src="Images/cardback.png" alt="bluefront" />
	 </div>
	</div>
            
  <script>
    const cards = document.querySelectorAll('.memory-card');
      let hasFlippedCard = false;
      //let flippedCards=new Array();
      let lockBoard = false;
      let firstCard, secondCard;
      let matches=0;
      let mmoves=0;

function flipCard() {
  if (lockBoard) return;
  if (this === firstCard) return;

  this.classList.add('flip');
  mmoves++;
    //alert("num moves "+mmoves);
  if (!hasFlippedCard) {
    hasFlippedCard = true;
    firstCard = this;

    return;
  }
  secondCard = this;
  checkForMatch();
}

function checkForMatch() {
  let isMatch = firstCard.dataset.framework === secondCard.dataset.framework;
  isMatch ? disableCards() : unflipCards();
}

function disableCards() {
  firstCard.removeEventListener('click', flipCard);
  secondCard.removeEventListener('click', flipCard);
    matches=matches+1;
    
    if(matches == 8){
        win();
    }

  resetBoard();
}

function win(){
    let win=document.getElementById("matchstatus");
    win.innerHTML="Congratulations, you won in "+ mmoves + " moves";
    let obj={};
    obj.action="Match";
    obj.moves=mmoves;
    ws.send(JSON.stringify(obj));
}

function unflipCards() {
  lockBoard = true;

  setTimeout(() => {
    firstCard.classList.remove('flip');
    secondCard.classList.remove('flip');

    resetBoard();
  }, 1200);
}

function resetBoard() {
  [hasFlippedCard, lockBoard] = [false, false];
  [firstCard, secondCard] = [null, null];
    //mmoves=0;
}

(function shuffle() {
  cards.forEach(card => {
    let randomPos = Math.floor(Math.random() * 12);
    card.style.order = randomPos;
  });
})();
      
      function resetGame(){
          firstCard=null;
          secondCard=null;
          hasFlippedCard=false;
          for(var i=0; i<cards.length; i++){
              cards[i].classList.remove('flip');
          }
          setTimeout(() => {
              cards.forEach(card => {
            let randomPos = Math.floor(Math.random() * 12);
            card.style.order = randomPos;
          });
         cards.forEach(card => card.addEventListener('click', flipCard));},500);
                           
          mmoves=0;
      }

cards.forEach(card => card.addEventListener('click', flipCard));
            </script>
</div>
    
    <div id="gofish" class="tabcontent">
        <div id="allfish">
            <div id="GoFish" class="statusBox">Go Fish</div>
            <center><input type="button" id="fishreset" value="Reset the game" style="font-size: 18px" onclick="fishRes()"></center>
            <div id="comfours"></div>
            <br><br><br><br><br><br><br>
            <h2>Computer</h2>
            <div id="fcpuhand"><img alt="cpuhand" src="Images/cardback.png"></div>
            <br><br><br><br><br><br>
            <h3 style="font-size: 25px;">Cards left in deck</h3>
            <label id="Deck size" style="font-size: 20px;"></label>
            <br><br>
            <div id="fishstatus" >
                <label id="fishstatus" style="font-size: 30px;">Click one of your cards to ask for it</label>
            </div>
            <br>
            <h2>Player 1</h2>
            <div id="fuserhand"><img alt="playehand" src="Images/cardback.png" title="start card"></div>
            <br><br><br><br><br><br><br><br><br>
            <div id="playerfours"></div>
            <br><br><br><br>
            <input type="button" value="Go Fish" id="No" style="font-size: 18px" onclick="no()">
        </div>
        
        <br><br>
        <h2>Toggle Online mode</h2>
        <br><br>
<label class="switch">
  <input type="checkbox" onclick="fishOnline()">
  <span class="slider"></span>
</label>
        <br><br><br>
        <h3>Feature coming soon</h3>
    <textarea maxlength="200"></textarea>
    <input type="text" size="50">
    <button value="Sumbit">Sumbit value</button>
        
        <button style="font-size: 20px" class="accordion">View Instructions</button>
        <div class="panel">
            <h2>Go Fish</h2>
            <p>Each Player starts out with 7 cards<br> 
                You can ask another player if they have a card matching one in your hand.<br>
                Simply click on the card you want to ask for.<br>
                If they have that card, he/she gives it to you.<br>
                If you don't you draw a card.<br>
                Your opponent will do the same thing to you<br>
                When asked for a card, click on all copies of that card to give them to your opponent.<br>
                If you do not have a card to play, simply hit the go fish button.
                If a player has 4 of a kind in their hand. They may get rid of those cards and set them aside.<br>
                If a player has no more cards in hand, that player draws five cards.<br>
                When there are no more cards, whoever has the most 4 of a kinds wins.<br>
                </p>
             <!--   <br><br>
                <p><b>Old rules</b><br>
            You can ask another player if they have a card matching one in your hand.<br>
            If they have that card, both you and your opponent place that card down.<br>
            If you don't you draw a card.<br>
            The first player to get rid of all the cards in their hand wins.</p>-->
        </div>
        
        <script src="Go-Fish/Fishpres.js"></script>
        <script src="Go-Fish/Fishview.js"></script>
        <script src="Online/FishpresO.js"></script>
        <script src="Online/FishviewO.js"></script>
        <script>
            'use strict'
            var fpres=new Fishpres(ws);
            fpres.play();
            let fishO=false;
            
            function no(){
                if(fishO){//call online version of go fish function
                    fpres.goFish();
                }
                else{
                    fpres.sayNo();
                }
            }
            
            function fishRes(){//reset the game offline
                fpres.resetGame();
            }
            
            function fishOnline(){//toggle online mode with go fish
                //alert("We are going online for Go fish");
                if(!fishO){//Port Go fish to online mode
                    fishO=true;
                    fpres.goOnline();
                    fpres=new FishpresO(ws);
                    
                    let mes={};
                    mes.action="Go Fish";
                    mes.gameact="Play";
                    ws.send(JSON.stringify(mes));
                    document.getElementById("fishreset").disabled=true;
                }else{
                        //shut off online mode
                        //alert("shutting off online mode");
                        fishO=false;
                        let quit={};
                        quit.action="Go Fish";
                        quit.gameact="quit";
                        ws.send(JSON.stringify(quit));
                        document.getElementById("fishreset").disabled=false;
                        fpres.goOffline();
                        fpres=new Fishpres();
                        fpres.play();
                }
                
            }
            function fishUpdate(message){
                //call method for updating go fish while online
                if(fishO){
                    fpres.update(message);
                }
                else{ document.getElementById('fishstatus').innerHTML=document.getElementById('fishstatus').innerHTML + " "+ message.message;
                }
            }
        </script>
    </div>
    
    <div id="solitare" class="tabcontent">
        <div id="Solstatus" class="statusBox">Spider Solitare</div>
        <center><input type="button" value="Reset the game" style="font-size: 18px" onclick="solreset()">.... 
        <input type="button" disabled value="Upload to leaderboard-Disabled" style="font-size: 18px" onclick="upload()"></center>
        
        <div id="row1" style="position: absolute; left: 20px"><img src="Images/cardback.png" alt="row1"></div>
        <div id="row2" style="position: absolute; left: 120px"><img src="Images/cardback.png" alt="row2"></div>
        <div id="row3" style="position: absolute; left: 220px"><img src="Images/cardback.png" alt="row3"></div>
        <div id="row4" style="position: absolute; left: 320px"><img src="Images/cardback.png" alt="row4"></div>
        <div id="row5" style="position: absolute; left: 420px"><img src="Images/cardback.png" alt="row5"></div>
        <div id="row6" style="position: absolute; left: 530px"><img src="Images/cardback.png" alt="row6"></div>
        <br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
        <div id="soldecks"><img alt="cards" src="Images/cardback.png"><img alt="cards" src="Images/cardback.png"><img alt="cards" src="Images/cardback.png"><img alt="cards" src="Images/cardback.png"></div>
        <div id="Vicdecks"></div>
        <br><br>
        <h3>Feature coming soon</h3>
    <textarea maxlength="200"></textarea>
    <input type="text" size="50">
    <button value="Sumbit">Sumbit value</button>
        
        <button style="font-size: 20px" class="accordion">View Instructions</button>
        <div class="panel">
            <h2>Solitare</h2>
            <p>The object of the game is to arrange each set of cards in order from ace to king<br>
            You will move cards around so that each card sits in front of the card that is one value point higher than it.<br>
            To move a card first click on the card you want to move, this will set up that card and each card below it to be moved.<br>
            Then, simply click the position that you want to move the card to.  The game will check if you made a legal move.<br>    
            If you run out of moves, you may take a side set of cards and deal them out, placing each card at the front of each row.<br>
            Flip over a card at the front of the row if there are no other cards in front of it.<br>    
            Once you get a group of cards in order from ace to king, ace having a value of one, take each of those cards and move them off to the side.<br>
            Once all of the cards are gone, you win the game.</p>
        </div>
        
        <script src="Solpres.js"></script>
        <script src="Solview.js"></script>
        <script src="Soldeck.js"></script>
    <script>
    "use strict";
        //Play one round of Solitare
        var spres = new Solpres(ws);
        spres.play();
        
       // for(var i=0; i<document.getElementById("row1").childElementCount; i++){
       //     spres.dragElement(document.getElementById("row1").childNodes[i]);
       // }
        //spres.dragElement(document.getElementById("row1").childNodes);
        //spres.dragElement(document.getElementById("row2"));
        //spres.dragElement(document.getElementById("row3"));
        //spres.dragElement(document.getElementById("row4"));
        //spres.dragElement(document.getElementById("row5"));
        //spres.dragElement(document.getElementById("row6"));
        
        function solreset(){
            spres.resetGame();
        }
        
        function upload(){
            //alert("uploading score to the database");
            spres.recordResult();
        }
        </script>
    </div>

<div id="War" class="tabcontent">
  <div id="warstatus" class="statusBox">War</div>
    <center><input type="button" id="warplay" style="font-size: 18px" onclick="deal()" value="Play a Round">... <input type="button" style="font-size: 18px" value="Reset the game" onclick="warReset()"></center>
    <h2>Click play a round to play. Play until deck is empty to upload your score.</h2>
    <br><br>
    <h2>Computer</h2>
    <div id="mywar"></div>
    <br><br><br><br><br><br>
    <div id="mycard"></div>
    <br><br><br><br><br><br>
    <h2>Player</h2>
    <div id="yourcard"></div>
    <br><br><br><br><br><br>
    <div id="yourwar"></div>
    <br><br><br><br><br><br><br>
    
    <button style="font-size: 20px" class="accordion">View Instructions</button>
        <div class="panel">
            <h3>Feature coming soon</h3>
    <textarea maxlength="200"></textarea>
    <input type="text" size="50">
    <button value="Sumbit">Sumbit value</button>
            
            <h2>War</h2>
            <p>The objective of the game is to win all cards.<br>
In unison, each player reveals the top card of their deck and the player with the higher card takes both of the cards played and moves them to their stack. Aces are high, and suits are ignored.<br>
If the two cards played are of equal value, then there is a "war".<br>
Both players place the next card of their pile face down, depending on the variant, and then another card face-up.<br> 
The owner of the higher face-up card wins the war and adds all six cards on the table to the bottom of their deck.<br>
If the face-up cards are again equal then the battle repeats with another set of face-down/up cards. <br>
            This repeats until one player's face-up card is higher than their opponent's.<br>
.</p>
        </div>
    
    <script src="Warpres.js"></script>
    <script src="Warview.js"></script>
    <script>
        "use strict"
        let warpres = new Warpres(ws);
        
        function deal(){
            warpres.dealCards();
        }
        
        function warReset(){
            //alert("Trying to reset war");
            warpres.resetGame();
        }
    </script>
    
</div>
    
<div id="sugestions" class="tabcontent">
    <center>
  <h3 style="font-size: 25px">Suggestions</h3>
  <p style="font-size: 18px">If you have any suggestions you would like to make
      or would like to report a bug,
    You may submit them down below.</p>.
    <br><br>
    <textarea id="sug"></textarea><br>
    <br><br>
    <input type="button" onclick=suggest() value="Submit">
    <br><br><br><br>
    </center>
    <script>
        function suggest(){
            if(document.getElementById("sug").value==""){
                return;
            }
            let obj={};
            obj.action="Suggest";
            var suggestion = document.getElementById("sug").value;
            obj.suggestion=suggestion;
            var table=document.getElementById("suggestion");
            document.getElementById("sug").value=" ";
            //table.innerHTML=table.innerHTML+user+"<br>";
            document.getElementById("sug").value=" ";
            ws.send(JSON.stringify(obj));
           // document.getElementById("pass").value=" ";
        }
    </script>
    
</div>
    
<div id="boards" class="tabcontent">
    <center>
<h3 style="font-size: 25px">Leaderboards</h3>
	
  <p style="font-size: 18px">Select the game to view the leaderboards.</p><br>
    <select id="leaderboards" name="Leaderboards">
        <option value="none">Select a leaderboard option</option>
        <option>Crazy Eights moves</option>
        <option>Snip Snap Snorum times</option>
        <option>Blackjack record</option>
        <option>Match moves</option>
        <option>Go Fish fours</option>
        <option>Solitare score</option>
        <option>War record</option>
    </select>
    <br><br>
   <input type="button" disabled onclick=load() value="Load Leaderboard-Disabled" ><br><br>
    <p id="score" style="font-size: 20px">If logged in, you will see your result appear first</p>
        <br><br><br><br>
    <p id="board" style="font-size: 20px"></p>
        <br><br><br><br>
        </center>
    <script>
		
        function load(){
            let obj={};
            obj.action="Leaderboard";
            var e = document.getElementById("leaderboards");
            var strUser = e.options[e.selectedIndex].text;
            if(strUser=="Select a leaderboard option"){
                document.getElementById("board").innerHTML="Please select a leaderboard option";
                return;
            }
            document.getElementById("board").innerHTML=strUser+"<br>";
            obj.board=strUser;
            ws.send(JSON.stringify(obj));
        }
    </script>
    
</div>
    
<script>
function openTab(evt, cityName) {//Code for opening tabs
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
    //evt.currentTarget.className += " active";
}
</script>
    <script>
        var acc = document.getElementsByClassName("accordion");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function() {
        /* Toggle between adding and removing the "active" class,
        to highlight the button that controls the panel */
        this.classList.toggle("active");

        /* Toggle between hiding and showing the active panel */
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
        panel.style.display = "none";
        } else {
        panel.style.display = "block";
        }
        });
        }
    </script>

</body>
</html>